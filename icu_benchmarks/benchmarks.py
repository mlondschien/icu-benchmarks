import numpy as np


def severinghaus_spo2_to_po2(spo2):
    """pO2 imputation from SpO2 using the Severinghaus equation."""
    # http://www.nickalls.org/dick/papers/anes/JWSrevised2007.pdf
    # Table 1:
    # PO2 %Sat PO2 %Sat PO2 %Sat
    # 1 0.60 34 65.16 80 95.84
    # 2 1.19 36 68.63 85 96.42
    # 4 2.56 38 71.94 90 96.88
    # 6 4.37 40 74.69 95 97.25
    # 8 6.68 42 77.29 100 97.49
    # 10 9.58 44 79.55 110 97.91
    # 12 12.96 46 81.71 120 98.21
    # 14 16.89 48 83.52 130 98.44
    # 16 21.40 50 85.08 140 98.62
    # 18 26.50 52 86.59 150 98.77
    # 20 32.12 54 87.70 175 99.03
    # 22 37.60 56 88.93 200 99.20
    # 24 43.14 58 89.95 225 99.32
    # 26 48.27 60 90.85 250 99.41
    # 28 53.16 65 92.73 300 99.53
    # 30 57.54 70 94.06 400 99.65
    # 32 61.69 75 95.10 500 99.72
    spo2_grid = np.array(
        [
            1,
            2,
            4,
            6,
            8,
            10,
            12,
            14,
            16,
            18,
            20,
            22,
            24,
            26,
            28,
            30,
            32,
            34,
            36,
            38,
            40,
            42,
            44,
            46,
            48,
            50,
            52,
            54,
            56,
            58,
            60,
            65,
            70,
            75,
            80,
            85,
            90,
            95,
            100,
            110,
            120,
            130,
            140,
            150,
            175,
            200,
            225,
            250,
            300,
            400,
            500,
        ]
    )
    po2_grid = np.array(
        [
            0.60,
            1.19,
            2.56,
            4.37,
            6.68,
            9.58,
            12.96,
            16.89,
            21.40,
            26.50,
            32.12,
            37.60,
            43.14,
            48.27,
            53.16,
            57.54,
            61.69,
            65.16,
            68.63,
            71.94,
            74.69,
            77.29,
            79.55,
            81.71,
            83.52,
            85.08,
            86.59,
            87.70,
            88.93,
            89.95,
            90.85,
            92.73,
            94.06,
            95.10,
            95.84,
            96.42,
            96.88,
            97.25,
            97.49,
            97.91,
            98.21,
            98.44,
            98.62,
            98.77,
            99.03,
            99.20,
            99.32,
            99.41,
            99.53,
            99.65,
            99.72,
        ]
    )
    return np.interp(spo2, spo2_grid, po2_grid)
